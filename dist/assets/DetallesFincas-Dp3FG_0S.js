import{r as m,c as M,o as wo,a as i,b as a,d as y,e as f,t as r,w as d,v as u,F as w,f as k,n as ko,g as q,h as $o,u as jo,i as c}from"./index-CB_AHI2y.js";const Eo={class:"container py-5"},To={class:"row justify-content-center"},Co={class:"col-lg-10"},Io={class:"card mb-4"},So={class:"card-body"},No={key:0,class:"card mb-4"},Ao={class:"card-body"},xo={class:"mb-3"},zo={class:"mb-3"},Uo={class:"mb-3"},Po={class:"list-group mb-2"},Bo={key:0,class:"list-group-item"},Vo={class:"input-group"},Do={class:"mb-3"},Oo={class:"list-group mb-2"},Go={key:0,class:"list-group-item"},Jo={class:"input-group"},Fo={class:"mt-2"},Mo={class:"mt-3"},qo={class:"mt-3"},Ro={class:"progress"},Lo=["aria-valuenow"],Ho={key:1,class:"card mb-4"},Ko={class:"card-body"},Qo={class:"list-group mb-3"},Wo=["onClick"],Xo={key:0,class:"list-group-item"},Yo={class:"mb-3 row g-2"},Zo={class:"col"},oa={class:"col"},aa={class:"card mb-4"},ta={class:"card-body"},ea={class:"list-group list-group-flush mb-3"},sa=["onClick"],na={key:0,class:"list-group-item"},ra={class:"mb-3 row g-2"},la={class:"col"},ia={class:"col"},ca={class:"col"},da={class:"card mb-4"},ua={class:"card-body"},pa={class:"list-group mb-3"},ma={class:"btn-group btn-group-sm",role:"group","aria-label":"Acciones tarea"},ga=["onClick"],va=["onClick"],ha={key:0,class:"list-group-item"},fa={class:"mb-3 row g-2"},ba={class:"col"},ya={class:"col"},_a={class:"col"},wa={class:"col"},ka={class:"col"},$a={class:"card mb-4"},ja={class:"card-body"},Ea={class:"list-group mb-3"},Ta={class:"ms-2 me-auto"},Ca={class:"fw-bold"},Ia={class:"text-muted"},Sa={class:"btn-group btn-group-sm mt-2",role:"group"},Na=["onClick"],Aa=["onClick"],xa={key:0,class:"list-group-item"},za={class:"row g-2 mb-3"},Ua={class:"col-md-2"},Pa={class:"col-md-2"},Ba={class:"col-md-2"},Va={class:"col-md-2"},Da={class:"col-md-3"},Oa={class:"col-md-1"},Ga={class:"card mb-4"},Ja={class:"card-body"},Fa={class:"list-group"},Ma={class:"fw-bold"},qa={class:"text-success"},Ra={key:0,class:"list-group-item text-muted"},Ka={__name:"DetallesFincas",setup(La){const l=m({}),Q=m(0),p=jo(),A=()=>{const e=l.value.objetivo_ingresos||0,o=l.value.dinero_ganado||0;Q.value=e>0?o/e*100:0},W=async()=>{const e=localStorage.getItem("token");if(!e)return alert("⚠️ No hay token");try{if(l.value.dinero_gastado=po.value,!(await fetch(`http://localhost:3000/api/fincas/${l.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({objetivo_ingresos:l.value.objetivo_ingresos,dinero_gastado:l.value.dinero_gastado,dinero_ganado:l.value.dinero_ganado})})).ok)throw new Error;alert("✅ Cambios guardados"),A()}catch{alert("❌ Error al guardar")}},X=async()=>{try{await W(),await vo(),alert("✅ Todos los cambios guardados correctamente")}catch(e){console.error(e),alert("❌ Error al guardar todos los cambios")}},Y=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const s=await fetch(`http://localhost:3000/api/fincas/${e}`,{headers:{Authorization:`Bearer ${o}`}});l.value=await s.json(),A()}catch(s){console.error(s)}},$=m([]),_=m({nombre:"",sueldo:0}),B=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`http://localhost:3000/api/fincas/${e}/trabajadores`,{headers:{Authorization:`Bearer ${o}`}})).json();$.value=n.trabajadores||[]}catch(s){console.error(s)}},Z=()=>{if(!_.value.nombre||_.value.sueldo<=0)return alert("Datos inválidos");$.value.push({..._.value}),_.value={nombre:"",sueldo:0}},oo=async e=>{const o=$.value[e];if(!(o!=null&&o.id))return alert("No se puede eliminar");const s=localStorage.getItem("token"),n=p.params.id;try{if(!(await fetch(`http://localhost:3000/api/fincas/${n}/trabajadores/${o.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error;alert("Eliminado"),await B()}catch(t){console.error(t),alert("Error al eliminar")}},ao=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`http://localhost:3000/api/fincas/${e}/trabajadores`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({trabajadores:$.value})})).ok)throw new Error;alert("Guardado correctamente"),await B()}catch(s){console.error(s),alert("Error al guardar")}},j=m([]),b=m({etapa:"",fecha_inicio:"",fecha_fin:""}),R=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`http://localhost:3000/api/fincas/${e}/calendario`,{headers:{Authorization:`Bearer ${o}`}})).json();j.value=n.calendario||[]}catch(s){console.error("Error al obtener calendario:",s)}},to=()=>{const{etapa:e,fecha_inicio:o,fecha_fin:s}=b.value;if(!e||!o||!s)return alert("Completa todos los campos");j.value.push({...b.value}),b.value={etapa:"",fecha_inicio:"",fecha_fin:""}},eo=e=>{j.value.splice(e,1)},so=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`http://localhost:3000/api/fincas/${e}/calendario`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({calendario:j.value})})).ok)throw new Error;alert("✅ Calendario guardado"),await R()}catch(s){console.error(s),alert("❌ Error al guardar calendario")}},E=m([]),h=m({titulo:"",descripcion:"",trabajadores:""}),no=()=>{if(!h.value.titulo)return alert("Título requerido");E.value.push({...h.value,completada:!1}),h.value={titulo:"",descripcion:"",trabajadores:""}},ro=e=>{E.value.splice(e,1)},lo=async e=>{const o=localStorage.getItem("token");if(!o)return alert("⚠️ No hay token");try{e.completada=!e.completada;const s=p.params.id;if(!e.id){alert("Esta tarea aún no está guardada en el servidor.");return}if(!(await fetch(`http://localhost:3000/api/fincas/${s}/tareas/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({completada:e.completada})})).ok)throw new Error;alert(`Tarea ${e.completada?"marcada como completada":"marcada como pendiente"}`),await V()}catch(s){alert("❌ Error al actualizar estado"),e.completada=!e.completada,console.error(s)}},io=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`http://localhost:3000/api/fincas/${e}/tareas`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({tareas:E.value})})).ok)throw new Error;alert("✅ Tareas guardadas"),await V()}catch(s){console.error(s),alert("❌ Error al guardar tareas")}},V=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`http://localhost:3000/api/fincas/${e}/tareas`,{headers:{Authorization:`Bearer ${o}`}})).json();E.value=n.tareas||[]}catch(s){console.error("Error al obtener tareas:",s)}},D=m(null),co=async()=>{const e=localStorage.getItem("token");if(e)try{const o=await fetch("http://localhost:3000/api/usuarios/me",{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Error al obtener usuario");D.value=await o.json()}catch(o){console.error("Error al obtener usuario actual:",o)}},I=m([]),T=m({descripcion:"",cantidad:0}),L=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const s=await fetch(`http://localhost:3000/api/gastos/${e}`,{headers:{Authorization:`Bearer ${o}`}});if(!s.ok)throw new Error("Error al obtener gastos");const n=await s.json();I.value=n||[]}catch(s){console.error("Error al obtener gastos:",s)}},uo=async()=>{const e=p.params.id,{descripcion:o,cantidad:s}=T.value,n=localStorage.getItem("token");if(!o||s<=0)return alert("Datos del gasto inválidos");try{if(!(await fetch("http://localhost:3000/api/gastos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({finca_id:e,descripcion:o,cantidad:s})})).ok)throw new Error("Error al agregar gasto");alert("✅ Gasto registrado"),T.value={descripcion:"",cantidad:0},await L(),await H()}catch(t){console.error(t),alert("❌ No se pudo registrar el gasto")}},H=async()=>{l.value.dinero_gastado=I.value.reduce((e,o)=>e+Number(o.cantidad),0),A()},po=M(()=>I.value.reduce((e,o)=>e+(parseFloat(o.cantidad)||0),0)),O=M(()=>{const e=l.value.dinero_ganado||0,o=l.value.dinero_gastado||0,s=l.value.objetivo_ingresos||0,n=e-o;return s===0?0:Math.max(0,Math.min(100,n/s*100))}),mo=M(()=>l.value.dinero_gastado>l.value.dinero_ganado?"bg-danger":"bg-success"),S=m([]),C=m({descripcion:"",cantidad:0}),go=async()=>{const e=p.params.id,{descripcion:o,cantidad:s}=C.value,n=localStorage.getItem("token");if(!o||s<=0)return alert("Datos de ingreso inválidos");try{if(!(await fetch("http://localhost:3000/api/fincas/"+e+"/ingresos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({finca_id:e,descripcion:o,cantidad:s})})).ok)throw new Error("Error al agregar ingreso");alert("✅ Ingreso registrado"),C.value={descripcion:"",cantidad:0},await G(),await K()}catch(t){console.error(t),alert("❌ No se pudo registrar el ingreso")}},vo=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const s=S.value.filter(n=>!n.id);for(const n of s){if(!n.descripcion||!n.cantidad)continue;if(!(await fetch(`http://localhost:3000/api/fincas/${e}/ingresos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({finca_id:e,descripcion:n.descripcion,cantidad:n.cantidad})})).ok)throw new Error("Error guardando ingreso")}alert("✅ Nuevos ingresos guardados correctamente"),await G()}catch(s){console.error(s),alert("❌ Error al guardar ingresos")}},G=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`http://localhost:3000/api/ingresos/${e}`,{headers:{Authorization:`Bearer ${o}`}})).json();S.value=n||[],await K()}catch(s){console.error("Error al obtener ingresos:",s)}},x=m([]),g=m({fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}),z=m(!1),J=m(null),U=async()=>{const e=p.params.id,o=localStorage.getItem("token"),n=await(await fetch(`http://localhost:3000/api/fincas/${e}/producciones`,{headers:{Authorization:`Bearer ${o}`}})).json();x.value=n.producciones||[]},ho=async()=>{const e=p.params.id,o=localStorage.getItem("token"),s={...g.value,finca_id:e};if(!(await fetch(`http://localhost:3000/api/fincas/${e}/producciones`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(s)})).ok)return alert("❌ Error al guardar");await U(),g.value={fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}},fo=e=>{const o=x.value[e];J.value=o.id,g.value={...o},z.value=!0},bo=async()=>{const e=p.params.id,o=localStorage.getItem("token"),s=J.value;if(!(await fetch(`http://localhost:3000/api/fincas/${e}/producciones/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(g.value)})).ok)return alert("❌ Error al actualizar");await U(),z.value=!1,J.value=null,g.value={fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}},yo=async e=>{const o=p.params.id,s=localStorage.getItem("token");if(!(await fetch(`http://localhost:3000/api/fincas/${o}/producciones/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)return alert("❌ Error al eliminar");await U()},F=m([]),_o=async()=>{const e=p.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`http://localhost:3000/api/fincas/${e}/rendimiento-producciones`,{headers:{Authorization:`Bearer ${o}`}})).json();F.value=n.producciones||[]}catch(s){console.error("❌ Error al obtener rendimiento:",s)}};wo(async()=>{await Y(),await B(),await R(),await V(),await L(),await co(),await H(),await G(),await U(),await _o()});const K=async()=>{l.value.dinero_ganado=S.value.reduce((e,o)=>e+Number(o.cantidad||0),0),A()},P=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"";return(e,o)=>{var s,n;return c(),i("div",Eo,[a("div",To,[a("div",Co,[a("div",Io,[o[27]||(o[27]=a("div",{class:"card-header bg-primary text-white fw-bold"},"🔖 Datos básicos",-1)),a("div",So,[a("p",null,[o[22]||(o[22]=a("strong",null,"Nombre:",-1)),f(" "+r(l.value.nombre),1)]),a("p",null,[o[23]||(o[23]=a("strong",null,"Ubicación (Municipio):",-1)),f(" "+r(l.value.municipio),1)]),a("p",null,[o[24]||(o[24]=a("strong",null,"Tamaño:",-1)),f(" "+r(l.value.tamano)+" ha",1)]),a("p",null,[o[25]||(o[25]=a("strong",null,"Tipo de cultivo:",-1)),f(" "+r(l.value.tipo_cultivo),1)]),a("p",null,[o[26]||(o[26]=a("strong",null,"Propietario (Usuario ID):",-1)),f(" "+r(l.value.usuario_id),1)])])]),((s=D.value)==null?void 0:s.rol)!=="trabajador"?(c(),i("div",No,[o[35]||(o[35]=a("div",{class:"card-header bg-success text-white fw-bold"},"💰 Sección Económica",-1)),a("div",Ao,[a("div",xo,[o[28]||(o[28]=a("label",{class:"form-label"},"Objetivo de ingresos:",-1)),d(a("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>l.value.objetivo_ingresos=t),type:"number",class:"form-control"},null,512),[[u,l.value.objetivo_ingresos,void 0,{number:!0}]])]),a("div",zo,[o[30]||(o[30]=a("label",{class:"form-label"},"Dinero gastado:",-1)),d(a("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>l.value.dinero_gastado=t),type:"number",class:"form-control"},null,512),[[u,l.value.dinero_gastado,void 0,{number:!0}]]),a("div",Uo,[o[29]||(o[29]=a("label",{class:"form-label"},"📑 Gastos detallados:",-1)),a("ul",Po,[(c(!0),i(w,null,k(I.value,(t,v)=>(c(),i("li",{key:v,class:"list-group-item d-flex justify-content-between"},[a("div",null,[a("strong",null,r(t.descripcion),1),f(": $"+r(t.cantidad),1)])]))),128)),I.value.length===0?(c(),i("li",Bo,"No hay gastos registrados.")):y("",!0)]),a("div",Vo,[d(a("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>T.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[u,T.value.descripcion]]),d(a("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>T.value.cantidad=t),type:"number",class:"form-control",placeholder:"Cantidad"},null,512),[[u,T.value.cantidad,void 0,{number:!0}]]),a("button",{class:"btn btn-outline-success",onClick:uo},"➕ Añadir gasto")])])]),a("div",Do,[o[32]||(o[32]=a("label",{class:"form-label"},"📈 Ingresos detallados:",-1)),a("ul",Oo,[(c(!0),i(w,null,k(S.value,(t,v)=>(c(),i("li",{key:v,class:"list-group-item d-flex justify-content-between"},[a("div",null,[a("strong",null,r(t.descripcion),1),f(": $"+r(t.cantidad),1)])]))),128)),S.value.length===0?(c(),i("li",Go,"No hay ingresos registrados.")):y("",!0)]),a("div",Jo,[d(a("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>C.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[u,C.value.descripcion]]),d(a("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>C.value.cantidad=t),type:"number",class:"form-control",placeholder:"Cantidad"},null,512),[[u,C.value.cantidad,void 0,{number:!0}]]),a("button",{class:"btn btn-outline-success",onClick:go},"➕ Añadir ingreso")]),a("p",Fo,[o[31]||(o[31]=a("strong",null,"💵 Total ganado:",-1)),f(" $"+r(l.value.dinero_ganado),1)])]),a("button",{onClick:X,class:"btn btn-sm btn-primary"},"💾 Guardar todos los cambios"),a("p",Mo,[o[33]||(o[33]=a("strong",null,"Ganancia estimada:",-1)),f(" $"+r(l.value.dinero_ganado-l.value.dinero_gastado),1)]),a("div",qo,[o[34]||(o[34]=a("label",{class:"form-label"},"📊 Progreso económico",-1)),a("div",Ro,[a("div",{class:q(["progress-bar",mo.value]),role:"progressbar",style:ko({width:O.value+"%"}),"aria-valuenow":O.value,"aria-valuemin":"0","aria-valuemax":"100"},r(O.value.toFixed(1))+"% ",15,Lo)])])])])):y("",!0),((n=D.value)==null?void 0:n.rol)!=="trabajador"?(c(),i("div",Ho,[o[36]||(o[36]=a("div",{class:"card-header bg-info text-white fw-bold"},"👨‍🌾 Trabajadores",-1)),a("div",Ko,[a("ul",Qo,[(c(!0),i(w,null,k($.value,(t,v)=>(c(),i("li",{key:t.id||v,class:"list-group-item d-flex justify-content-between align-items-center"},[a("div",null,[a("strong",null,r(t.nombre),1),f(" — $"+r(t.sueldo),1)]),a("button",{onClick:N=>oo(v),class:"btn btn-danger btn-sm"},"Eliminar",8,Wo)]))),128)),$.value.length===0?(c(),i("li",Xo," No hay trabajadores registrados. ")):y("",!0)]),a("div",Yo,[a("div",Zo,[d(a("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>_.value.nombre=t),type:"text",class:"form-control",placeholder:"Nombre"},null,512),[[u,_.value.nombre]])]),a("div",oa,[d(a("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>_.value.sueldo=t),type:"number",class:"form-control",placeholder:"Sueldo"},null,512),[[u,_.value.sueldo,void 0,{number:!0}]])]),a("div",{class:"col-auto"},[a("button",{onClick:Z,class:"btn btn-success"},"Añadir")])]),a("button",{onClick:ao,class:"btn btn-primary"},"💾 Guardar Trabajadores")])])):y("",!0),a("div",aa,[o[37]||(o[37]=a("div",{class:"card-header bg-warning text-dark fw-bold"},"🗓️ Calendario de cultivo",-1)),a("div",ta,[a("ul",ea,[(c(!0),i(w,null,k(j.value,(t,v)=>(c(),i("li",{key:t.id||v,class:"list-group-item d-flex justify-content-between align-items-center"},[a("div",null,[a("strong",null,r(t.etapa)+":",1),f(" "+r(t.fecha_inicio)+" hasta "+r(t.fecha_fin),1)]),a("button",{class:"btn btn-sm btn-danger",onClick:N=>eo(v)},"🗑️",8,sa)]))),128)),j.value.length===0?(c(),i("li",na," No hay etapas registradas. ")):y("",!0)]),a("div",ra,[a("div",la,[d(a("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>b.value.etapa=t),type:"text",class:"form-control",placeholder:"Nombre de la etapa"},null,512),[[u,b.value.etapa]])]),a("div",ia,[d(a("input",{"onUpdate:modelValue":o[9]||(o[9]=t=>b.value.fecha_inicio=t),type:"date",class:"form-control"},null,512),[[u,b.value.fecha_inicio]])]),a("div",ca,[d(a("input",{"onUpdate:modelValue":o[10]||(o[10]=t=>b.value.fecha_fin=t),type:"date",class:"form-control"},null,512),[[u,b.value.fecha_fin]])]),a("div",{class:"col-auto"},[a("button",{onClick:to,class:"btn btn-success"},"➕ Añadir")])]),a("button",{onClick:so,class:"btn btn-primary"},"💾 Guardar Calendario")])]),a("div",da,[o[41]||(o[41]=a("div",{class:"card-header bg-secondary text-white fw-bold"},"📋 Tareas",-1)),a("div",ua,[a("ul",pa,[(c(!0),i(w,null,k(E.value,(t,v)=>(c(),i("li",{key:t.id||v,class:q(["list-group-item d-flex justify-content-between align-items-center",{"list-group-item-success":t.completada}])},[a("div",null,[a("strong",null,r(t.titulo),1),o[39]||(o[39]=a("br",null,null,-1)),a("small",null,r(t.descripcion),1),o[40]||(o[40]=a("br",null,null,-1)),a("small",null,[o[38]||(o[38]=a("em",null,"Asignados:",-1)),f(" "+r(t.trabajadores||"Ninguno"),1)])]),a("div",ma,[a("button",{onClick:N=>lo(t),class:q(t.completada?"btn btn-success":"btn btn-outline-secondary"),title:"Marcar como completada"}," ✔️ ",10,ga),a("button",{onClick:N=>ro(v),class:"btn btn-danger"},"🗑️",8,va)])],2))),128)),E.value.length===0?(c(),i("li",ha," No hay tareas registradas. ")):y("",!0)]),a("div",fa,[a("div",ba,[d(a("input",{"onUpdate:modelValue":o[11]||(o[11]=t=>h.value.titulo=t),type:"text",class:"form-control",placeholder:"Título de la tarea"},null,512),[[u,h.value.titulo]])]),a("div",ya,[d(a("input",{"onUpdate:modelValue":o[12]||(o[12]=t=>h.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[u,h.value.descripcion]])]),a("div",_a,[d(a("input",{"onUpdate:modelValue":o[13]||(o[13]=t=>h.value.trabajadores=t),type:"text",class:"form-control",placeholder:"Trabajadores (separados por coma)"},null,512),[[u,h.value.trabajadores]])]),a("div",wa,[d(a("input",{"onUpdate:modelValue":o[14]||(o[14]=t=>h.value.fecha_inicio=t),type:"date",class:"form-control",placeholder:"Fecha inicio"},null,512),[[u,h.value.fecha_inicio]])]),a("div",ka,[d(a("input",{"onUpdate:modelValue":o[15]||(o[15]=t=>h.value.fecha_fin=t),type:"date",class:"form-control",placeholder:"Fecha fin"},null,512),[[u,h.value.fecha_fin]])]),a("div",{class:"col-auto"},[a("button",{onClick:no,class:"btn btn-success"},"➕ Añadir")])]),a("button",{onClick:io,class:"btn btn-primary"},"💾 Guardar Tareas")])]),a("div",$a,[o[45]||(o[45]=a("div",{class:"card-header bg-info text-white fw-bold"},"📦 Producciones",-1)),a("div",ja,[a("ul",Ea,[(c(!0),i(w,null,k(x.value,(t,v)=>(c(),i("li",{key:t.id,class:"list-group-item d-flex justify-content-between align-items-start"},[a("div",Ta,[a("div",Ca,r(t.tipo==="en_proceso"?"🟡 En proceso":"✅ Terminada"),1),a("small",null,r(P(t.fecha_inicio))+" → "+r(P(t.fecha_fin)),1),o[42]||(o[42]=a("br",null,null,-1)),a("small",null,r(t.cantidad)+" unidades",1),o[43]||(o[43]=a("br",null,null,-1)),a("small",Ia,r(t.descripcion),1)]),a("div",Sa,[a("button",{onClick:N=>fo(v),class:"btn btn-warning"},"✏️",8,Na),a("button",{onClick:N=>yo(t.id),class:"btn btn-danger"},"🗑️",8,Aa)])]))),128)),x.value.length===0?(c(),i("li",xa,"No hay producciones registradas.")):y("",!0)]),a("div",za,[a("div",Ua,[d(a("input",{type:"date","onUpdate:modelValue":o[16]||(o[16]=t=>g.value.fecha_inicio=t),class:"form-control",required:""},null,512),[[u,g.value.fecha_inicio]])]),a("div",Pa,[d(a("input",{type:"date","onUpdate:modelValue":o[17]||(o[17]=t=>g.value.fecha_fin=t),class:"form-control",required:""},null,512),[[u,g.value.fecha_fin]])]),a("div",Ba,[d(a("select",{"onUpdate:modelValue":o[18]||(o[18]=t=>g.value.tipo=t),class:"form-select",required:""},o[44]||(o[44]=[a("option",{disabled:"",value:""},"Tipo",-1),a("option",{value:"en_proceso"},"En Proceso",-1),a("option",{value:"terminada"},"Terminada",-1)]),512),[[$o,g.value.tipo]])]),a("div",Va,[d(a("input",{type:"number","onUpdate:modelValue":o[19]||(o[19]=t=>g.value.cantidad=t),class:"form-control",placeholder:"Cantidad",required:""},null,512),[[u,g.value.cantidad]])]),a("div",Da,[d(a("input",{type:"text","onUpdate:modelValue":o[20]||(o[20]=t=>g.value.descripcion=t),class:"form-control",placeholder:"Descripción"},null,512),[[u,g.value.descripcion]])]),a("div",Oa,[a("button",{onClick:o[21]||(o[21]=t=>z.value?bo():ho()),class:"btn btn-success w-100"},r(z.value?"💾":"➕"),1)])])])]),a("div",Ga,[o[50]||(o[50]=a("div",{class:"card-header bg-info text-white fw-bold"},"📈 Rendimiento por Producción",-1)),a("div",Ja,[a("ul",Fa,[(c(!0),i(w,null,k(F.value,t=>(c(),i("li",{key:t.produccion_id,class:"list-group-item"},[a("div",Ma,r(t.descripcion||"Sin descripción"),1),a("small",null,"📅 "+r(P(t.fecha_inicio))+" → "+r(P(t.fecha_fin)),1),o[46]||(o[46]=a("br",null,null,-1)),a("small",null,"📦 Producción: "+r(t.produccion)+" unidades",1),o[47]||(o[47]=a("br",null,null,-1)),a("small",null,"💸 Gastos: €"+r(t.total_gastos),1),o[48]||(o[48]=a("br",null,null,-1)),a("small",null,"💰 Ingresos: €"+r(t.total_ingresos),1),o[49]||(o[49]=a("br",null,null,-1)),a("strong",qa,"💹 Rendimiento: €"+r(t.rendimiento),1)]))),128)),F.value.length===0?(c(),i("li",Ra," No hay datos de rendimiento aún. ")):y("",!0)])])])])])])}}};export{Ka as default};
