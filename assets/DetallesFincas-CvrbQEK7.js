import{r as g,c as R,o as ko,a as l,b as a,d as _,e as h,t as r,w as u,v as p,F as k,f as $,n as $o,g as q,h as jo,u as Eo,i as c}from"./index-6EkS_v6t.js";const To={class:"container py-5"},Co={class:"row justify-content-center"},Io={class:"col-lg-10"},So={class:"card mb-4"},No={class:"card-body"},Ao={key:0,class:"card mb-4"},xo={class:"card-body"},zo={class:"mb-3"},Uo={class:"mb-3"},Po={class:"mb-3"},Bo={class:"list-group mb-2"},Vo={key:0,class:"list-group-item"},Do={class:"input-group"},Oo={class:"mb-3"},Go={class:"list-group mb-2"},Jo={key:0,class:"list-group-item"},Fo={class:"input-group"},Mo={class:"mt-2"},Ro={class:"mt-3"},qo={class:"mt-3"},Lo={class:"progress"},Ho=["aria-valuenow"],Ko={key:1,class:"card mb-4"},Qo={class:"card-body"},Wo={class:"list-group mb-3"},Xo=["onClick"],Yo={key:0,class:"list-group-item"},Zo={class:"mb-3 row g-2"},oa={class:"col"},aa={class:"col"},ta={class:"card mb-4"},ea={class:"card-body"},sa={class:"list-group list-group-flush mb-3"},na=["onClick"],ra={key:0,class:"list-group-item"},ia={class:"mb-3 row g-2"},la={class:"col"},ca={class:"col"},da={class:"col"},ua={class:"card mb-4"},pa={class:"card-body"},ma={class:"list-group mb-3"},ga={class:"btn-group btn-group-sm",role:"group","aria-label":"Acciones tarea"},va=["onClick"],fa=["onClick"],ba={key:0,class:"list-group-item"},ha={class:"mb-3 row g-2"},ya={class:"col"},_a={class:"col"},wa={class:"col"},ka={class:"col"},$a={class:"col"},ja={class:"card mb-4"},Ea={class:"card-body"},Ta={class:"list-group mb-3"},Ca={class:"ms-2 me-auto"},Ia={class:"fw-bold"},Sa={class:"text-muted"},Na={class:"btn-group btn-group-sm mt-2",role:"group"},Aa=["onClick"],xa=["onClick"],za={key:0,class:"list-group-item"},Ua={class:"row g-2 mb-3"},Pa={class:"col-md-2"},Ba={class:"col-md-2"},Va={class:"col-md-2"},Da={class:"col-md-2"},Oa={class:"col-md-3"},Ga={class:"col-md-1"},Ja={class:"card mb-4"},Fa={class:"card-body"},Ma={class:"list-group"},Ra={class:"fw-bold"},qa={class:"text-success"},La={key:0,class:"list-group-item text-muted"},Qa={__name:"DetallesFincas",setup(Ha){const d="https://tfg-14u9.onrender.com",i=g({}),W=g(0),m=Eo(),x=()=>{const e=i.value.objetivo_ingresos||0,o=i.value.dinero_ganado||0;W.value=e>0?o/e*100:0},X=async()=>{const e=localStorage.getItem("token");if(!e)return alert("⚠️ No hay token");try{if(i.value.dinero_gastado=mo.value,!(await fetch(`${d}/api/fincas/${i.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({objetivo_ingresos:i.value.objetivo_ingresos,dinero_gastado:i.value.dinero_gastado,dinero_ganado:i.value.dinero_ganado})})).ok)throw new Error;alert("✅ Cambios guardados"),x()}catch{alert("❌ Error al guardar")}},Y=async()=>{try{await X(),await fo(),alert("✅ Todos los cambios guardados correctamente")}catch(e){console.error(e),alert("❌ Error al guardar todos los cambios")}},Z=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const s=await fetch(`${d}/api/fincas/${e}`,{headers:{Authorization:`Bearer ${o}`}});i.value=await s.json(),x()}catch(s){console.error(s)}},j=g([]),w=g({nombre:"",sueldo:0}),V=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`${d}/api/fincas/${e}/trabajadores`,{headers:{Authorization:`Bearer ${o}`}})).json();j.value=n.trabajadores||[]}catch(s){console.error(s)}},oo=()=>{if(!w.value.nombre||w.value.sueldo<=0)return alert("Datos inválidos");j.value.push({...w.value}),w.value={nombre:"",sueldo:0}},ao=async e=>{const o=j.value[e];if(!(o!=null&&o.id))return alert("No se puede eliminar");const s=localStorage.getItem("token"),n=m.params.id;try{if(!(await fetch(`${d}/api/fincas/${n}/trabajadores/${o.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error;alert("Eliminado"),await V()}catch(t){console.error(t),alert("Error al eliminar")}},to=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`${d}/api/fincas/${e}/trabajadores`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({trabajadores:j.value})})).ok)throw new Error;alert("Guardado correctamente"),await V()}catch(s){console.error(s),alert("Error al guardar")}},E=g([]),y=g({etapa:"",fecha_inicio:"",fecha_fin:""}),L=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`${d}/api/fincas/${e}/calendario`,{headers:{Authorization:`Bearer ${o}`}})).json();E.value=n.calendario||[]}catch(s){console.error("Error al obtener calendario:",s)}},eo=()=>{const{etapa:e,fecha_inicio:o,fecha_fin:s}=y.value;if(!e||!o||!s)return alert("Completa todos los campos");E.value.push({...y.value}),y.value={etapa:"",fecha_inicio:"",fecha_fin:""}},so=e=>{E.value.splice(e,1)},no=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`${d}/api/fincas/${e}/calendario`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({calendario:E.value})})).ok)throw new Error;alert("✅ Calendario guardado"),await L()}catch(s){console.error(s),alert("❌ Error al guardar calendario")}},T=g([]),b=g({titulo:"",descripcion:"",trabajadores:""}),ro=()=>{if(!b.value.titulo)return alert("Título requerido");T.value.push({...b.value,completada:!1}),b.value={titulo:"",descripcion:"",trabajadores:""}},io=e=>{T.value.splice(e,1)},lo=async e=>{const o=localStorage.getItem("token");if(!o)return alert("⚠️ No hay token");try{e.completada=!e.completada;const s=m.params.id;if(!e.id){alert("Esta tarea aún no está guardada en el servidor.");return}if(!(await fetch(`${d}/api/fincas/${s}/tareas/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({completada:e.completada})})).ok)throw new Error;alert(`Tarea ${e.completada?"marcada como completada":"marcada como pendiente"}`),await D()}catch(s){alert("❌ Error al actualizar estado"),e.completada=!e.completada,console.error(s)}},co=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{if(!(await fetch(`${d}/api/fincas/${e}/tareas`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({tareas:T.value})})).ok)throw new Error;alert("✅ Tareas guardadas"),await D()}catch(s){console.error(s),alert("❌ Error al guardar tareas")}},D=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`${d}/api/fincas/${e}/tareas`,{headers:{Authorization:`Bearer ${o}`}})).json();T.value=n.tareas||[]}catch(s){console.error("Error al obtener tareas:",s)}},O=g(null),uo=async()=>{const e=localStorage.getItem("token");if(e)try{const o=await fetch(`${d}/api/usuarios/me`,{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Error al obtener usuario");O.value=await o.json()}catch(o){console.error("Error al obtener usuario actual:",o)}},S=g([]),C=g({descripcion:"",cantidad:0}),H=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const s=await fetch(`${d}/api/gastos/${e}`,{headers:{Authorization:`Bearer ${o}`}});if(!s.ok)throw new Error("Error al obtener gastos");const n=await s.json();S.value=n||[]}catch(s){console.error("Error al obtener gastos:",s)}},po=async()=>{const e=m.params.id,{descripcion:o,cantidad:s}=C.value,n=localStorage.getItem("token");if(!o||s<=0)return alert("Datos del gasto inválidos");try{if(!(await fetch(`${d}/api/gastos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({finca_id:e,descripcion:o,cantidad:s})})).ok)throw new Error("Error al agregar gasto");alert("✅ Gasto registrado"),C.value={descripcion:"",cantidad:0},await H(),await K()}catch(t){console.error(t),alert("❌ No se pudo registrar el gasto")}},K=async()=>{i.value.dinero_gastado=S.value.reduce((e,o)=>e+Number(o.cantidad),0),x()},mo=R(()=>S.value.reduce((e,o)=>e+(parseFloat(o.cantidad)||0),0)),G=R(()=>{const e=i.value.dinero_ganado||0,o=i.value.dinero_gastado||0,s=i.value.objetivo_ingresos||0,n=e-o;return s===0?0:Math.max(0,Math.min(100,n/s*100))}),go=R(()=>i.value.dinero_gastado>i.value.dinero_ganado?"bg-danger":"bg-success"),N=g([]),I=g({descripcion:"",cantidad:0}),vo=async()=>{const e=m.params.id,{descripcion:o,cantidad:s}=I.value,n=localStorage.getItem("token");if(!o||s<=0)return alert("Datos de ingreso inválidos");try{if(!(await fetch(`${d}/api/fincas/${e}/ingresos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({finca_id:e,descripcion:o,cantidad:s})})).ok)throw new Error("Error al agregar ingreso");alert("✅ Ingreso registrado"),I.value={descripcion:"",cantidad:0},await J(),await Q()}catch(t){console.error(t),alert("❌ No se pudo registrar el ingreso")}},fo=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const s=N.value.filter(n=>!n.id);for(const n of s){if(!n.descripcion||!n.cantidad)continue;if(!(await fetch(`${d}/api/fincas/${e}/ingresos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({finca_id:e,descripcion:n.descripcion,cantidad:n.cantidad})})).ok)throw new Error("Error guardando ingreso")}alert("✅ Nuevos ingresos guardados correctamente"),await J()}catch(s){console.error(s),alert("❌ Error al guardar ingresos")}},J=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`${d}/api/ingresos/${e}`,{headers:{Authorization:`Bearer ${o}`}})).json();N.value=n||[],await Q()}catch(s){console.error("Error al obtener ingresos:",s)}},z=g([]),v=g({fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}),U=g(!1),F=g(null),P=async()=>{const e=m.params.id,o=localStorage.getItem("token"),n=await(await fetch(`${d}/api/fincas/${e}/producciones`,{headers:{Authorization:`Bearer ${o}`}})).json();z.value=n.producciones||[]},bo=async()=>{const e=m.params.id,o=localStorage.getItem("token"),s={...v.value,finca_id:e};if(!(await fetch(`${d}/api/fincas/${e}/producciones`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(s)})).ok)return alert("❌ Error al guardar");await P(),v.value={fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}},ho=e=>{const o=z.value[e];F.value=o.id,v.value={...o},U.value=!0},yo=async()=>{const e=m.params.id,o=localStorage.getItem("token"),s=F.value;if(!(await fetch(`${d}/api/fincas/${e}/producciones/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(v.value)})).ok)return alert("❌ Error al actualizar");await P(),U.value=!1,F.value=null,v.value={fecha_inicio:"",fecha_fin:"",tipo:"",cantidad:null,descripcion:""}},_o=async e=>{const o=m.params.id,s=localStorage.getItem("token");if(!(await fetch(`${d}/api/fincas/${o}/producciones/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)return alert("❌ Error al eliminar");await P()},M=g([]),wo=async()=>{const e=m.params.id,o=localStorage.getItem("token");try{const n=await(await fetch(`${d}/api/fincas/${e}/rendimiento-producciones`,{headers:{Authorization:`Bearer ${o}`}})).json();M.value=n.producciones||[]}catch(s){console.error("❌ Error al obtener rendimiento:",s)}};ko(async()=>{await Z(),await V(),await L(),await D(),await H(),await uo(),await K(),await J(),await P(),await wo()});const Q=async()=>{i.value.dinero_ganado=N.value.reduce((e,o)=>e+Number(o.cantidad||0),0),x()},B=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"";return(e,o)=>{var s,n;return c(),l("div",To,[a("div",Co,[a("div",Io,[a("div",So,[o[27]||(o[27]=a("div",{class:"card-header bg-primary text-white fw-bold"},"🔖 Datos básicos",-1)),a("div",No,[a("p",null,[o[22]||(o[22]=a("strong",null,"Nombre:",-1)),h(" "+r(i.value.nombre),1)]),a("p",null,[o[23]||(o[23]=a("strong",null,"Ubicación (Municipio):",-1)),h(" "+r(i.value.municipio),1)]),a("p",null,[o[24]||(o[24]=a("strong",null,"Tamaño:",-1)),h(" "+r(i.value.tamano)+" ha",1)]),a("p",null,[o[25]||(o[25]=a("strong",null,"Tipo de cultivo:",-1)),h(" "+r(i.value.tipo_cultivo),1)]),a("p",null,[o[26]||(o[26]=a("strong",null,"Propietario (Usuario ID):",-1)),h(" "+r(i.value.usuario_id),1)])])]),((s=O.value)==null?void 0:s.rol)!=="trabajador"?(c(),l("div",Ao,[o[35]||(o[35]=a("div",{class:"card-header bg-success text-white fw-bold"},"💰 Sección Económica",-1)),a("div",xo,[a("div",zo,[o[28]||(o[28]=a("label",{class:"form-label"},"Objetivo de ingresos:",-1)),u(a("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>i.value.objetivo_ingresos=t),type:"number",class:"form-control"},null,512),[[p,i.value.objetivo_ingresos,void 0,{number:!0}]])]),a("div",Uo,[o[30]||(o[30]=a("label",{class:"form-label"},"Dinero gastado:",-1)),u(a("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.dinero_gastado=t),type:"number",class:"form-control"},null,512),[[p,i.value.dinero_gastado,void 0,{number:!0}]]),a("div",Po,[o[29]||(o[29]=a("label",{class:"form-label"},"📑 Gastos detallados:",-1)),a("ul",Bo,[(c(!0),l(k,null,$(S.value,(t,f)=>(c(),l("li",{key:f,class:"list-group-item d-flex justify-content-between"},[a("div",null,[a("strong",null,r(t.descripcion),1),h(": $"+r(t.cantidad),1)])]))),128)),S.value.length===0?(c(),l("li",Vo,"No hay gastos registrados.")):_("",!0)]),a("div",Do,[u(a("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>C.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[p,C.value.descripcion]]),u(a("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>C.value.cantidad=t),type:"number",class:"form-control",placeholder:"Cantidad"},null,512),[[p,C.value.cantidad,void 0,{number:!0}]]),a("button",{class:"btn btn-outline-success",onClick:po},"➕ Añadir gasto")])])]),a("div",Oo,[o[32]||(o[32]=a("label",{class:"form-label"},"📈 Ingresos detallados:",-1)),a("ul",Go,[(c(!0),l(k,null,$(N.value,(t,f)=>(c(),l("li",{key:f,class:"list-group-item d-flex justify-content-between"},[a("div",null,[a("strong",null,r(t.descripcion),1),h(": $"+r(t.cantidad),1)])]))),128)),N.value.length===0?(c(),l("li",Jo,"No hay ingresos registrados.")):_("",!0)]),a("div",Fo,[u(a("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>I.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[p,I.value.descripcion]]),u(a("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>I.value.cantidad=t),type:"number",class:"form-control",placeholder:"Cantidad"},null,512),[[p,I.value.cantidad,void 0,{number:!0}]]),a("button",{class:"btn btn-outline-success",onClick:vo},"➕ Añadir ingreso")]),a("p",Mo,[o[31]||(o[31]=a("strong",null,"💵 Total ganado:",-1)),h(" $"+r(i.value.dinero_ganado),1)])]),a("button",{onClick:Y,class:"btn btn-sm btn-primary"},"💾 Guardar todos los cambios"),a("p",Ro,[o[33]||(o[33]=a("strong",null,"Ganancia estimada:",-1)),h(" $"+r(i.value.dinero_ganado-i.value.dinero_gastado),1)]),a("div",qo,[o[34]||(o[34]=a("label",{class:"form-label"},"📊 Progreso económico",-1)),a("div",Lo,[a("div",{class:q(["progress-bar",go.value]),role:"progressbar",style:$o({width:G.value+"%"}),"aria-valuenow":G.value,"aria-valuemin":"0","aria-valuemax":"100"},r(G.value.toFixed(1))+"% ",15,Ho)])])])])):_("",!0),((n=O.value)==null?void 0:n.rol)!=="trabajador"?(c(),l("div",Ko,[o[36]||(o[36]=a("div",{class:"card-header bg-info text-white fw-bold"},"👨‍🌾 Trabajadores",-1)),a("div",Qo,[a("ul",Wo,[(c(!0),l(k,null,$(j.value,(t,f)=>(c(),l("li",{key:t.id||f,class:"list-group-item d-flex justify-content-between align-items-center"},[a("div",null,[a("strong",null,r(t.nombre),1),h(" — $"+r(t.sueldo),1)]),a("button",{onClick:A=>ao(f),class:"btn btn-danger btn-sm"},"Eliminar",8,Xo)]))),128)),j.value.length===0?(c(),l("li",Yo," No hay trabajadores registrados. ")):_("",!0)]),a("div",Zo,[a("div",oa,[u(a("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>w.value.nombre=t),type:"text",class:"form-control",placeholder:"Nombre"},null,512),[[p,w.value.nombre]])]),a("div",aa,[u(a("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>w.value.sueldo=t),type:"number",class:"form-control",placeholder:"Sueldo"},null,512),[[p,w.value.sueldo,void 0,{number:!0}]])]),a("div",{class:"col-auto"},[a("button",{onClick:oo,class:"btn btn-success"},"Añadir")])]),a("button",{onClick:to,class:"btn btn-primary"},"💾 Guardar Trabajadores")])])):_("",!0),a("div",ta,[o[37]||(o[37]=a("div",{class:"card-header bg-warning text-dark fw-bold"},"🗓️ Calendario de cultivo",-1)),a("div",ea,[a("ul",sa,[(c(!0),l(k,null,$(E.value,(t,f)=>(c(),l("li",{key:t.id||f,class:"list-group-item d-flex justify-content-between align-items-center"},[a("div",null,[a("strong",null,r(t.etapa)+":",1),h(" "+r(t.fecha_inicio)+" hasta "+r(t.fecha_fin),1)]),a("button",{class:"btn btn-sm btn-danger",onClick:A=>so(f)},"🗑️",8,na)]))),128)),E.value.length===0?(c(),l("li",ra," No hay etapas registradas. ")):_("",!0)]),a("div",ia,[a("div",la,[u(a("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>y.value.etapa=t),type:"text",class:"form-control",placeholder:"Nombre de la etapa"},null,512),[[p,y.value.etapa]])]),a("div",ca,[u(a("input",{"onUpdate:modelValue":o[9]||(o[9]=t=>y.value.fecha_inicio=t),type:"date",class:"form-control"},null,512),[[p,y.value.fecha_inicio]])]),a("div",da,[u(a("input",{"onUpdate:modelValue":o[10]||(o[10]=t=>y.value.fecha_fin=t),type:"date",class:"form-control"},null,512),[[p,y.value.fecha_fin]])]),a("div",{class:"col-auto"},[a("button",{onClick:eo,class:"btn btn-success"},"➕ Añadir")])]),a("button",{onClick:no,class:"btn btn-primary"},"💾 Guardar Calendario")])]),a("div",ua,[o[41]||(o[41]=a("div",{class:"card-header bg-secondary text-white fw-bold"},"📋 Tareas",-1)),a("div",pa,[a("ul",ma,[(c(!0),l(k,null,$(T.value,(t,f)=>(c(),l("li",{key:t.id||f,class:q(["list-group-item d-flex justify-content-between align-items-center",{"list-group-item-success":t.completada}])},[a("div",null,[a("strong",null,r(t.titulo),1),o[39]||(o[39]=a("br",null,null,-1)),a("small",null,r(t.descripcion),1),o[40]||(o[40]=a("br",null,null,-1)),a("small",null,[o[38]||(o[38]=a("em",null,"Asignados:",-1)),h(" "+r(t.trabajadores||"Ninguno"),1)])]),a("div",ga,[a("button",{onClick:A=>lo(t),class:q(t.completada?"btn btn-success":"btn btn-outline-secondary"),title:"Marcar como completada"}," ✔️ ",10,va),a("button",{onClick:A=>io(f),class:"btn btn-danger"},"🗑️",8,fa)])],2))),128)),T.value.length===0?(c(),l("li",ba," No hay tareas registradas. ")):_("",!0)]),a("div",ha,[a("div",ya,[u(a("input",{"onUpdate:modelValue":o[11]||(o[11]=t=>b.value.titulo=t),type:"text",class:"form-control",placeholder:"Título de la tarea"},null,512),[[p,b.value.titulo]])]),a("div",_a,[u(a("input",{"onUpdate:modelValue":o[12]||(o[12]=t=>b.value.descripcion=t),type:"text",class:"form-control",placeholder:"Descripción"},null,512),[[p,b.value.descripcion]])]),a("div",wa,[u(a("input",{"onUpdate:modelValue":o[13]||(o[13]=t=>b.value.trabajadores=t),type:"text",class:"form-control",placeholder:"Trabajadores (separados por coma)"},null,512),[[p,b.value.trabajadores]])]),a("div",ka,[u(a("input",{"onUpdate:modelValue":o[14]||(o[14]=t=>b.value.fecha_inicio=t),type:"date",class:"form-control",placeholder:"Fecha inicio"},null,512),[[p,b.value.fecha_inicio]])]),a("div",$a,[u(a("input",{"onUpdate:modelValue":o[15]||(o[15]=t=>b.value.fecha_fin=t),type:"date",class:"form-control",placeholder:"Fecha fin"},null,512),[[p,b.value.fecha_fin]])]),a("div",{class:"col-auto"},[a("button",{onClick:ro,class:"btn btn-success"},"➕ Añadir")])]),a("button",{onClick:co,class:"btn btn-primary"},"💾 Guardar Tareas")])]),a("div",ja,[o[45]||(o[45]=a("div",{class:"card-header bg-info text-white fw-bold"},"📦 Producciones",-1)),a("div",Ea,[a("ul",Ta,[(c(!0),l(k,null,$(z.value,(t,f)=>(c(),l("li",{key:t.id,class:"list-group-item d-flex justify-content-between align-items-start"},[a("div",Ca,[a("div",Ia,r(t.tipo==="en_proceso"?"🟡 En proceso":"✅ Terminada"),1),a("small",null,r(B(t.fecha_inicio))+" → "+r(B(t.fecha_fin)),1),o[42]||(o[42]=a("br",null,null,-1)),a("small",null,r(t.cantidad)+" unidades",1),o[43]||(o[43]=a("br",null,null,-1)),a("small",Sa,r(t.descripcion),1)]),a("div",Na,[a("button",{onClick:A=>ho(f),class:"btn btn-warning"},"✏️",8,Aa),a("button",{onClick:A=>_o(t.id),class:"btn btn-danger"},"🗑️",8,xa)])]))),128)),z.value.length===0?(c(),l("li",za,"No hay producciones registradas.")):_("",!0)]),a("div",Ua,[a("div",Pa,[u(a("input",{type:"date","onUpdate:modelValue":o[16]||(o[16]=t=>v.value.fecha_inicio=t),class:"form-control",required:""},null,512),[[p,v.value.fecha_inicio]])]),a("div",Ba,[u(a("input",{type:"date","onUpdate:modelValue":o[17]||(o[17]=t=>v.value.fecha_fin=t),class:"form-control",required:""},null,512),[[p,v.value.fecha_fin]])]),a("div",Va,[u(a("select",{"onUpdate:modelValue":o[18]||(o[18]=t=>v.value.tipo=t),class:"form-select",required:""},o[44]||(o[44]=[a("option",{disabled:"",value:""},"Tipo",-1),a("option",{value:"en_proceso"},"En Proceso",-1),a("option",{value:"terminada"},"Terminada",-1)]),512),[[jo,v.value.tipo]])]),a("div",Da,[u(a("input",{type:"number","onUpdate:modelValue":o[19]||(o[19]=t=>v.value.cantidad=t),class:"form-control",placeholder:"Cantidad",required:""},null,512),[[p,v.value.cantidad]])]),a("div",Oa,[u(a("input",{type:"text","onUpdate:modelValue":o[20]||(o[20]=t=>v.value.descripcion=t),class:"form-control",placeholder:"Descripción"},null,512),[[p,v.value.descripcion]])]),a("div",Ga,[a("button",{onClick:o[21]||(o[21]=t=>U.value?yo():bo()),class:"btn btn-success w-100"},r(U.value?"💾":"➕"),1)])])])]),a("div",Ja,[o[50]||(o[50]=a("div",{class:"card-header bg-info text-white fw-bold"},"📈 Rendimiento por Producción",-1)),a("div",Fa,[a("ul",Ma,[(c(!0),l(k,null,$(M.value,t=>(c(),l("li",{key:t.produccion_id,class:"list-group-item"},[a("div",Ra,r(t.descripcion||"Sin descripción"),1),a("small",null,"📅 "+r(B(t.fecha_inicio))+" → "+r(B(t.fecha_fin)),1),o[46]||(o[46]=a("br",null,null,-1)),a("small",null,"📦 Producción: "+r(t.produccion)+" unidades",1),o[47]||(o[47]=a("br",null,null,-1)),a("small",null,"💸 Gastos: €"+r(t.total_gastos),1),o[48]||(o[48]=a("br",null,null,-1)),a("small",null,"💰 Ingresos: €"+r(t.total_ingresos),1),o[49]||(o[49]=a("br",null,null,-1)),a("strong",qa,"💹 Rendimiento: €"+r(t.rendimiento),1)]))),128)),M.value.length===0?(c(),l("li",La," No hay datos de rendimiento aún. ")):_("",!0)])])])])])])}}};export{Qa as default};
